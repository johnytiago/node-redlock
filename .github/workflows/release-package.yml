name: Publish NPM Package

on:
  release:
    types: [created]

env:
  DOCKER_BUILDKIT: '1'
  GITHUB_ACCESS_TOKEN: ${{ secrets.GIT_TOKEN }}
  DOCKER_REGISTRY_USER: ${{ secrets.DOCKER_REGISTRY_USER }}
  DOCKER_REGISTRY_PASS: ${{ secrets.DOCKER_REGISTRY_PASS }}

jobs:
  publish_npm_package:
    name: Publish npm package
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout source code
        uses: actions/checkout@v2
      - name: Login to Docker registry
        run: make login
      - name: Publish npm package
        run: make publish